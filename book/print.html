<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Network Security Notes</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="FIT5037 - Network Security Notes">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Network Security Notes</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/ibnvhasan/NetSec" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="network-security-notes"><a class="header" href="#network-security-notes">Network Security Notes</a></h1>
<h2 id="week-1-network-architecture-and-protocols-review"><a class="header" href="#week-1-network-architecture-and-protocols-review">Week 1: Network Architecture and Protocols Review</a></h2>
<h2 id="week-2-public-key-infrastructure-pki-and-digital-certificates"><a class="header" href="#week-2-public-key-infrastructure-pki-and-digital-certificates">Week 2: Public Key Infrastructure (PKI) and Digital Certificates</a></h2>
<div style="break-before: page; page-break-before: always;"></div><h1 id="week-1-applied-class-notes"><a class="header" href="#week-1-applied-class-notes">Week 1 Applied Class Notes</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="week-2-applied-class-material"><a class="header" href="#week-2-applied-class-material">Week 2 Applied Class Material</a></h1>
<blockquote>
<p>The exercises are designed for students to finish in an individual capacity. The exercises are not designed to be completed in tutorial sessions but rather to give you some tasks and a starting point to continue and complete on your own.</p>
</blockquote>
<hr />
<h2 id="lab-overview"><a class="header" href="#lab-overview">Lab Overview</a></h2>
<p>Public key cryptography is the foundation of today’s secure communication, but it is subject to man-in-the-middle attacks when one side of communication sends its public key to the other side. The fundamental problem is that there is no easy way to verify the ownership of a public key, i.e., given a public key and its claimed owner information, how do we ensure that the public key is indeed owned by the claimed owner? The Public Key Infrastructure (PKI) is a practical solution to this problem. The learning objective of this lab is for students to gain the first-hand experience on PKI. By doing the tasks in this lab, students should be able to gain a better understanding of how PKI works, how PKI is used to protect the Web, and how Man-in-the-middle attacks can be defeated by PKI. Moreover, students will be able to understand the root of the trust in the public-key infrastructure, and what problems will arise if the root trust is broken.</p>
<hr />
<h2 id="lab-tasks"><a class="header" href="#lab-tasks">Lab Tasks</a></h2>
<p>Open SecureCorp network configuration in GNS3 and start all nodes. We will add 2 new Ubuntu-24.04-plus-essentials nodes (Internal-Web and CA) to the Server LAN with static IPs to perform this lab. You can find the static IP configurations in the Appendix section at the end of this document. Before starting the configurations, make the /etc and /usr directories persistent on both Internal-Web and CA nodes by right-clicking the node &gt; Configure &gt; Advanced. Stop and start both nodes after the configurations.</p>
<h3 id="1-becoming-a-certificate-authority-ca"><a class="header" href="#1-becoming-a-certificate-authority-ca">1. Becoming a Certificate Authority (CA)</a></h3>
<p>A <strong>Certificate Authority (CA)</strong> is a trusted entity that issues digital certificates. The digital certificate certifies the ownership of a public key by the named subject of the certificate. A number of commercial CAs are treated as root CAs; This is a list of the leading public SSL certificate authorities by market share. Users who want to get digital certificates issued by the commercial CAs need to pay those CAs. In this lab, we need to create digital certificates, but we are not going to pay any commercial CA. We will become a root CA ourselves, and then use this CA to issue certificate for others (e.g. servers). In this task, we will make ourselves a root CA, and generate a certificate for this CA. Unlike other certificates, which are usually signed by another CA, the root CA’s certificates are self-signed. Root CA’s certificates are usually pre-loaded into most operating systems, web browsers, and other software that rely on PKI. Root CA’s certificates are unconditionally trusted.</p>
<p>We will use <code>Internal-Web</code> container as web server and access the website using <code>Internal-Client-2</code>. The openssl configuration file is located in: <code>/usr/lib/ssl/openssl.cnf</code>. According to configuration file we need to create directories for our certificates, see <code>[CA_default]</code> part in the configuration file. Let’s make directories on the CA, open terminal (right click on the CA node and select console), and execute the following:</p>
<pre><code class="language-bash"># move to /root directory
cd
mkdir pki
cd pki
mkdir demoCA
mkdir certs
mkdir crl
mkdir newcerts
touch index.txt
echo 1000 &gt; serial
</code></pre>
<ul>
<li><input disabled="" type="checkbox" checked=""/>
<strong><code>demoCA</code></strong> is Where everything is kept</li>
<li><input disabled="" type="checkbox" checked=""/>
<strong><code>certs</code></strong> is Where the issued certs are kept</li>
<li><input disabled="" type="checkbox" checked=""/>
<strong><code>crl</code></strong> is Where the issued crl are kept</li>
<li><input disabled="" type="checkbox" checked=""/>
<strong><code>newcerts</code></strong> is the default place for new certs</li>
<li><input disabled="" type="checkbox" checked=""/>
<strong><code>index.txt</code></strong> is database index file</li>
<li><input disabled="" type="checkbox" checked=""/>
<strong><code>serial</code></strong> is the current serial number</li>
</ul>
<p>All commands from here onward should be run from the pki directory. Run the below command to confirm your working directory is /root/pki.</p>
<pre><code class="language-bash">pwd
</code></pre>
<p>By default OpenSSL configures itself as an internal CA which is only signing certificates for the same organisation. We need to change this configurations so that our CA can sign certificate for any domain name. Find the following section in the configuration file <code>/usr/lib/ssl/openssl.cnf</code> and change them as below.</p>
<pre><code class="language-bash"># you can use nano /usr/lib/ssl/openssl.cnf
# then press ctrl + W and write policy_match to find it
[ policy_match ]
countryName = optional
stateOrProvinceName = optional
organizationName = optional
organizationalUnitName = optional
commonName = supplied
emailAddress = optional
</code></pre>
<p>Alright, we are ready to generate a self-signed certificate for our CA. This means that this CA is totally trusted, and its certificate will serve as the root certificate. You can run the following command to generate a self-signed certificate for the CA:</p>
<pre><code class="language-bash">openssl req -new -x509 -keyout ca.key -out ca.crt
</code></pre>
<h3 id="2-creating-a-certificate-for-networksecuritycom"><a class="header" href="#2-creating-a-certificate-for-networksecuritycom">2. Creating a Certificate for <strong>networksecurity.com</strong></a></h3>
<p>Now, we become a root CA, we are ready to sign digital certificates for our customers. Our first customer is a company called networksecurity.com. We assume that the web server of networksecurity.com is <code>Internal-Web</code> node in Server LAN. Perform the following three steps in <code>Internal-Web</code> node.</p>
<h4 id="a-generate-publicprivate-key-pair"><a class="header" href="#a-generate-publicprivate-key-pair">a) Generate public/private key pair:</a></h4>
<p>The company needs to first create its own public/private key pair. We can run the following command to generate an RSA key pair (both private and public keys). The keys will be stored in the file server.pem:</p>
<pre><code class="language-bash">cd
apt install openssl
openssl genrsa -out server.pem 2048
</code></pre>
<p>The <code>server.pem</code> is an encoded text file, so you will not be able to see the actual content, such as the modulus, private exponents, etc. To see those, you can run the following command:</p>
<pre><code>openssl rsa -in server.pem -text
</code></pre>
<h4 id="b-generating-certificates"><a class="header" href="#b-generating-certificates">b) Generating Certificates:</a></h4>
<p>The CSR file needs to have the CA’s signature to form a certificate. In the real world, the CSR files are usually sent to a trusted CA for their signature. In this lab, we will use our own trusted CA to generate certificates. Copy the content of server.csr from <code>Internal-Web</code> to CA. Execute the following command on CA to turn the certificate signing request <code>server.csr</code> into an X509 certificate server.crt, using the CA’s <code>ca.crt</code> and <code>ca.key</code>:</p>
<pre><code>openssl ca -in server.csr -out server.crt -cert ca.crt -keyfile ca.key
</code></pre>
<p>Copy the certificate file (<code>server.crt</code>) to the <code>Internal-Web</code> server</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="workshop-1"><a class="header" href="#workshop-1">Workshop 1</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="workshop-2"><a class="header" href="#workshop-2">Workshop 2</a></h1>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>


    </div>
    </body>
</html>
